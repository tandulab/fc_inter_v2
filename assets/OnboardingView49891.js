import{s as R,v as _,x as E,S as T,f as S,y as x,d as $,z as N,l as j,m as z,p as D,c as p,h as V,g as v,t as k,u as y,F,A as I,r as B,q as C,o as w,n as L,B as M,j as G}from"../index49891.js";import{A as K}from"./AppProgressBar49891.js";import{P as U}from"./PrimaryButton49891.js";import{a as Y,b as H,u as J}from"./auth49891.js";class q{static async surveyStart(){return await Y("/surveys/start")}static async surveyAnswer(e){return await H("/surveys/answer",e)}}const Q=R("survey-store",()=>{const a=_(null),e=E(T.SURVEY_COMPLETED,!1),r=S(()=>{var s;return(s=a.value)==null?void 0:s.question}),l=S(()=>{var s;return((s=a.value)==null?void 0:s.played)??!1});async function u(){a.value=await q.surveyStart(),e.value=a.value.completed??!1}async function c(s){const o=J().user_id;if(!r.value||!o)return;const m={customer_id:r.value.customer_id,customer_activity_id:r.value.customer_activity_id,question_id:r.value.id,option_ids:s.map(f=>f.id)};a.value=await q.surveyAnswer(m),e.value=a.value.completed??!1}function n(){a.value=null,e.value=null}return{survey:x(a),completed:x(e),question:r,played:l,surveyStart:u,surveySendAnswer:c,$reset:n}}),W={class:"flex md:items-center flex-col"},X={class:"md:max-w-[57vw] lg:max-w-[58vw] md:text-center mb-[2rem] mt-[2.4rem] md:mb-[4rem]"},Z=["onClick"],ee={class:"text"},ae={class:"flex w-full md:justify-end"},se=$({__name:"OnboardingView",setup(a){const e=_(null),r=Q(),{question:l,completed:u}=N(r),{lang:c}=j(),n=_(!1),{setLoading:s}=z(),o=S(()=>{var t;return(t=l.value)==null?void 0:t.answers}),m=t=>{e.value=t};function f(){P()}async function O(){try{await r.surveyStart(),u.value&&await B.push({name:C.AVATARS})}catch(t){console.error(t)}finally{s(!1)}}async function P(){try{if(n.value=!0,!e.value)return;await r.surveySendAnswer([e.value]),e.value=null,u.value&&await B.push({name:C.AVATARS})}catch(t){console.error(t)}finally{n.value=!1}}return D(()=>{s(!0),O()}),(t,i)=>{var g,b;return w(),p("div",W,[V(K,{value:75,class:"mt-[3rem]"}),v("h1",X,k((b=(g=y(l))==null?void 0:g.languages)==null?void 0:b[y(c)]),1),(w(!0),p(F,null,I(o.value,(d,h)=>{var A;return w(),p("div",{key:h,class:L(["w-full border-1 border-white/25 option-container",{"border-b-0":o.value&&h!==o.value.length-1}])},[v("div",{class:L(["text-white uppercase w-full py-[1.5rem] text-center option",{selected:((A=e.value)==null?void 0:A.id)===d.id}]),onClick:te=>m(d)},[v("div",ee,k(d.languages[y(c)]),1),i[1]||(i[1]=M('<div class="corners" data-v-79e972f6><span class="corner top-left" data-v-79e972f6></span><span class="corner top-right" data-v-79e972f6></span><span class="corner bottom-left" data-v-79e972f6></span><span class="corner bottom-right" data-v-79e972f6></span></div><div class="hover-blur" data-v-79e972f6></div>',2))],10,Z)],2)}),128)),v("div",ae,[V(U,{label:t.$t("button.continue"),class:"mt-[4rem] mb-[3rem] w-full md:w-auto","surface-color":"blue",disabled:!e.value,loading:n.value,onClick:i[0]||(i[0]=d=>f())},null,8,["label","disabled","loading"])])])}}}),ue=G(se,[["__scopeId","data-v-79e972f6"]]);export{ue as default};
